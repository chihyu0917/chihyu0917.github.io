<html>
    <head>
        <title>Produce 48 Ranking</title>
        <script>
            function loadXMLDoc(filename) {
                var xhttp = new XMLHttpRequest();
                xhttp.open("GET", filename, false);
                xhttp.send("");
                return xhttp.responseXML;
            }

            function displayResult(xslFile) {
                var xml = loadXMLDoc("data.xml");
                var xsl = loadXMLDoc(xslFile);

                if (xml && xsl) {
                    try {
                        var xsltProcessor = new XSLTProcessor();
                        xsltProcessor.importStylesheet(xsl);
                        var resultDocument = xsltProcessor.transformToFragment(xml, document);
                        if (resultDocument) {
                            document.getElementById("xslresult").innerHTML = "<h1>Produce 48 Ranking</h1><p><b>摘要：</b>" + "</p>";
                            document.getElementById("xslresult").appendChild(resultDocument);
                        } else {
                            console.error("Transformation returned null.");
                        }
                    } catch (e) {
                        console.error("Error during XSLT processing:", e);
                    }
                } else {
                    console.error("Failed to load XML or XSL file.");
                }
            }


            function init() {
                displayResult();
            }

            function viewsrc() {
                alert(document.body.innerHTML);
            }
        </script>
    </head>
    <body onload="init();">
        <div id="xslhead"></div>
        <hr>
        <button onclick="displayResult('ex1.xsl');">名稱排序</button>
        <button onclick="displayResult('ex2.xsl');">價格排序</button>
        <button onclick="viewsrc();">檢視原始檔</button>
        <hr>
        <div id="xslresult"></div>
    </body>
</html>
