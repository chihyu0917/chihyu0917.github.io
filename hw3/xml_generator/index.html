<html>
    <head>
        <title>Shopping Cart</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <script>
            function loadXMLDoc(filename) {
                var xhttp = new XMLHttpRequest();
                xhttp.open("GET", filename, false);
                xhttp.send("");
                return xhttp.responseXML;
            }

            function displayResult() {
                var xml = loadXMLDoc("data.xml");
                console.log(xml);
                // var xsl = loadXMLDoc(xslFile);

                // if (xml && xsl) {
                if (xml) {
                    try {
                        // var xsltProcessor = new XSLTProcessor();
                        // xsltProcessor.importStylesheet(xsl);
                        // var resultDocument = xsltProcessor.transformToFragment(xml, document);
                        // var resultDocument = xml;
                        // if (resultDocument) {
                        //     document.getElementById("xmllist").innerHTML = "<h1>Produce 48 Ranking</h1><p><b>簡介：</b>" + "韓國Mnet的2018年選秀節目，最後前12名組成女團IZ*ONE" + "</p>";
                        //     document.getElementById("xmllist").appendChild(resultDocument);
                        
                        // } else {
                        //     console.error("Transformation returned null.");
                        // }
                        // Parse the XML
                        // var parser = new DOMParser();
                        // var xmlDoc = parser.parseFromString(xml, "text/xml");
                        // var xmlDoc = xml.responseXML;
                        var xmlDoc = xml;   
                        console.log(xmlDoc);

                        // Generate HTML
                        var orders = xmlDoc.getElementsByTagName("Order");
                        var cartHtml = "<ul>";
                        for (var i = 0; i < orders.length; i++) {
                            cartHtml += "<li>" + 
                                orders[i].getElementsByTagName("Singer")[0].textContent + "<br>" +
                                orders[i].getElementsByTagName("AlbumName")[0].textContent + "<br>" +
                                orders[i].getElementsByTagName("AlbumPrice")[0].textContent +
                                "</li>";
                        }
                        cartHtml += "</ul>";

                        // Display in cart
                        document.getElementById("xmllist").innerHTML = cartHtml;

                    } catch (e) {
                        console.error("Error during XSLT processing:", e);
                    }
                } else {
                    // console.error("Failed to load XML or XSL file.");
                }
            }


            function init() {
                displayResult();
            }

            function viewsrc() {
                alert(document.body.innerHTML);
            }
        </script>
    </head>
    <body onload="init();">
        <header>
            <nav>
                <ul>
                    <li><a href="../xml_viewer/index.html">XML Viewer</a></li>
                    <li><a href="index.html">XML Generator</a></li>
                </ul>
            </nav>
        </header>
        <div id="xslhead"></div>
        <hr>
        <button onclick="displayResult('ex1.xsl');">訂購</button>
        <button onclick="displayResult('ex2.xsl');">一公排名</button>
        <button onclick="displayResult('ex3.xsl');">最終排名</button>
        <button onclick="viewsrc();">檢視原始檔</button>
        <div id="others">
            <button><a href="ex1.xsl">初評級 (xsl)</a></button>
            <button><a href="ex.xml">輸入資料 (xml)</a></button>
        </div>
        <hr>
        <div id="xmllist"></div>
        <footer>
            <p>GitHub <a href="https://github.com/chihyu0917">@chihyu0917</p>
        </footer>
    </body>
</html>
